mpw-algorithm_v2.c