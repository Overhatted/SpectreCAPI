mpw-algorithm_v1.c