mpw-algorithm_v3.c